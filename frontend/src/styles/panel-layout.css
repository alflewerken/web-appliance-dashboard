/* Multi-Panel Layout System - Simplified Version */

/* Main container adjusts to panel widths */
.music-app {
  position: relative;
  display: flex;
  height: 100vh;
  overflow: hidden;
  --total-panel-width: 0px;
}

/* Calculate total panel width based on open panels */
/* Using a more maintainable approach with individual panel calculations */

/* Base calculation for each panel when open */
.music-app.has-host-panel {
  --host-panel-active-width: var(--host-panel-width, 600px);
}
.music-app:not(.has-host-panel) {
  --host-panel-active-width: 0px;
}

.music-app.has-service-panel {
  --service-panel-active-width: var(--service-panel-width, 600px);
}
.music-app:not(.has-service-panel) {
  --service-panel-active-width: 0px;
}

.music-app.has-user-panel {
  --user-panel-active-width: var(--user-panel-width, 600px);
}
.music-app:not(.has-user-panel) {
  --user-panel-active-width: 0px;
}

.music-app.has-settings-panel {
  --settings-panel-active-width: var(--settings-panel-width, 600px);
}
.music-app:not(.has-settings-panel) {
  --settings-panel-active-width: 0px;
}

.music-app.has-audit-log-panel {
  --audit-log-panel-active-width: var(--audit-log-panel-width, 800px);
}
.music-app:not(.has-audit-log-panel) {
  --audit-log-panel-active-width: 0px;
}

/* Total width calculation - always sum all active panels */
.music-app {
  --total-panel-width: calc(
    var(--host-panel-active-width, 0px) +
    var(--service-panel-active-width, 0px) +
    var(--user-panel-active-width, 0px) +
    var(--settings-panel-active-width, 0px) +
    var(--audit-log-panel-active-width, 0px)
  );
}

/* Main content area that shrinks when panels are open */
.main-content {
  flex: 1;
  margin-right: var(--total-panel-width);
  transition: margin-right 0.3s ease;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  position: relative;
  min-width: 0;
}

/* CRITICAL: Base panel styling with high specificity */
.music-app .panel-container {
  position: fixed !important;
  top: 0 !important;
  bottom: 0 !important;
  height: 100vh !important;
  transition: transform 0.3s ease;
  z-index: 1300;
  /* Use transform instead of right for better performance */
  transform: translateX(calc(100% + 100px));
  display: block !important;
  /* WICHTIG: Transparenter Hintergrund für Container */
  background: transparent !important;
}

/* Override any MUI Box styles */
.panel-container > .MuiBox-root {
  height: 100% !important;
  position: relative !important;
  max-width: none !important;
}

/* Panel positioning - Order from right to left: Audit-Log → Settings → User → Service → Host → Main */

/* Audit Log Panel - Always rightmost when open */
.music-app.has-audit-log-panel .audit-log-panel-container {
  transform: translateX(0) !important;
  right: 0 !important;
}

/* Settings Panel - Slides based on Audit Log */
.music-app.has-settings-panel:not(.has-audit-log-panel) .settings-panel-container {
  transform: translateX(0) !important;
  right: 0 !important;
}

.music-app.has-settings-panel.has-audit-log-panel .settings-panel-container {
  transform: translateX(0) !important;
  right: var(--audit-log-panel-width, 800px) !important;
}

/* User Panel - Slides based on Settings and Audit Log */
.music-app.has-user-panel .user-panel-container {
  transform: translateX(0) !important;
  right: calc(
    var(--settings-panel-active-width, 0px) +
    var(--audit-log-panel-active-width, 0px)
  ) !important;
}

/* Service Panel - Slides based on User, Settings and Audit Log */
.music-app.has-service-panel .service-panel-container {
  transform: translateX(0) !important;
  right: calc(
    var(--user-panel-active-width, 0px) +
    var(--settings-panel-active-width, 0px) +
    var(--audit-log-panel-active-width, 0px)
  ) !important;
}

/* Host Panel - Slides based on Service, User, Settings and Audit Log */
.music-app.has-host-panel .host-panel-container {
  transform: translateX(0) !important;
  right: calc(
    var(--service-panel-active-width, 0px) +
    var(--user-panel-active-width, 0px) +
    var(--settings-panel-active-width, 0px) +
    var(--audit-log-panel-active-width, 0px)
  ) !important;
}

/* Add subtle shadows for depth */
.panel-container {
  box-shadow: -2px 0 10px rgba(0, 0, 0, 0.3);
}

/* Ensure panel containers are transparent */
.audit-log-panel-container,
.service-panel-container,
.user-panel-container,
.settings-panel-container,
.host-panel-container {
  background: transparent !important;
}

/* Ensure smooth animations */
.panel-container * {
  transition: none !important; /* Prevent child elements from interfering with panel animations */
}

/* Debug helper - add colored borders to see layout */
.music-app[data-panels*="host"] .main-content {
  /* Force recalculation when host panel is open */
  margin-right: var(--total-panel-width) !important;
}

/* Mobile overrides */
@media (max-width: 768px) {
  .music-app {
    --total-panel-width: 0px !important;
    --host-panel-active-width: 0px !important;
    --service-panel-active-width: 0px !important;
    --user-panel-active-width: 0px !important;
    --settings-panel-active-width: 0px !important;
    --audit-log-panel-active-width: 0px !important;
  }

  .main-content {
    margin-right: 0 !important;
  }

  .music-app .panel-container {
    width: 100% !important;
    width: 100vw !important;
    transform: translateX(100%) !important;
    right: auto !important;
    left: 0 !important;
    /* Safe Area Support - nur für top/bottom, left/right werden in Kindern behandelt */
    padding-top: env(safe-area-inset-top, 0);
    padding-bottom: env(safe-area-inset-bottom, 0);
    /* WICHTIG: Keine horizontalen Paddings hier! */
    padding-left: 0;
    padding-right: 0;
    box-sizing: border-box !important;
  }

  /* Ensure panels fill entire viewport width without overflow */
  .music-app.has-service-panel .service-panel-container,
  .music-app.has-user-panel .user-panel-container,
  .music-app.has-settings-panel .settings-panel-container,
  .music-app.has-audit-log-panel .audit-log-panel-container,
  .music-app.has-host-panel .host-panel-container {
    transform: translateX(0) !important;
    right: 0 !important;
    left: 0 !important;
    width: 100vw !important;
    max-width: 100vw !important;
    overflow-x: hidden !important;
  }

  /* Only show one panel at a time on mobile */
  .music-app.has-service-panel .user-panel-container,
  .music-app.has-service-panel .settings-panel-container,
  .music-app.has-service-panel .audit-log-panel-container,
  .music-app.has-service-panel .host-panel-container,
  .music-app.has-user-panel .service-panel-container,
  .music-app.has-user-panel .settings-panel-container,
  .music-app.has-user-panel .audit-log-panel-container,
  .music-app.has-user-panel .host-panel-container,
  .music-app.has-settings-panel .service-panel-container,
  .music-app.has-settings-panel .user-panel-container,
  .music-app.has-settings-panel .audit-log-panel-container,
  .music-app.has-settings-panel .host-panel-container,
  .music-app.has-audit-log-panel .service-panel-container,
  .music-app.has-audit-log-panel .user-panel-container,
  .music-app.has-audit-log-panel .settings-panel-container,
  .music-app.has-audit-log-panel .host-panel-container,
  .music-app.has-host-panel .service-panel-container,
  .music-app.has-host-panel .user-panel-container,
  .music-app.has-host-panel .settings-panel-container,
  .music-app.has-host-panel .audit-log-panel-container {
    display: none !important;
  }
}

/* Debugging - Log calculated values */
.music-app {
  /* Use counter to debug values */
  counter-reset: total-width var(--total-panel-width);
}

.music-app::before {
  content: "Total panel width: " counter(total-width) "px";
  position: fixed;
  bottom: 10px;
  left: 10px;
  background: rgba(0, 0, 0, 0.8);
  color: white;
  padding: 5px 10px;
  font-size: 12px;
  z-index: 9999;
  display: none; /* Enable for debugging */
}
