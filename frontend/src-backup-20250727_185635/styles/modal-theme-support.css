/* ========================================================================
   MODAL THEME SUPPORT - DARK & LIGHT MODE
   ========================================================================
   Ensures all modals are readable in both dark and light themes
   ======================================================================== */

/* ========================================================================
   GENERAL MODAL STYLES - BOTH THEMES
   ======================================================================== */

/* Modal overlay - transparent for both themes */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  padding: 20px;
  animation: fadeIn 0.2s ease-out;
}

/* ========================================================================
   DARK MODE (DEFAULT) - White text on dark backgrounds
   ======================================================================== */

/* Modal container - Dark Mode */
body:not(.theme-light) .modal,
body:not(.theme-light) .category-modal,
body:not(.theme-light) .settings-modal,
body:not(.theme-light) .terminal-modal,
body:not(.theme-light) .service-copy-modal,
body:not(.theme-light) .slider-modal,
body:not(.theme-light) .ssh-manager-modal,
body:not(.theme-light) .icon-selector-modal,
body:not(.theme-light) .audit-log-modal,
body:not(.theme-light) .mobile-modal {
  background: #1c1c1e;
  color: #ffffff;
  border: 1px solid rgba(255, 255, 255, 0.1);
}

/* Modal header - Dark Mode */
body:not(.theme-light) .modal-header {
  color: #ffffff;
  border-bottom-color: rgba(255, 255, 255, 0.1);
}

body:not(.theme-light) .modal-header h2,
body:not(.theme-light) .modal-header h3 {
  color: #ffffff;
}

/* Form elements - Dark Mode */
body:not(.theme-light) .modal label,
body:not(.theme-light) .modal .form-group label {
  color: rgba(255, 255, 255, 0.9);
}

body:not(.theme-light) .modal input,
body:not(.theme-light) .modal select,
body:not(.theme-light) .modal textarea {
  background: rgba(255, 255, 255, 0.05);
  color: #ffffff;
  border-color: rgba(255, 255, 255, 0.2);
}

body:not(.theme-light) .modal input::placeholder,
body:not(.theme-light) .modal textarea::placeholder {
  color: rgba(255, 255, 255, 0.5);
}

/* Modal footer - Dark Mode */
body:not(.theme-light) .modal-footer {
  background: #1c1c1e;
  border-top-color: rgba(255, 255, 255, 0.1);
}

/* Buttons - Dark Mode */
body:not(.theme-light) .modal .btn-secondary {
  background: rgba(255, 255, 255, 0.1);
  color: #ffffff;
  border-color: rgba(255, 255, 255, 0.2);
}

body:not(.theme-light) .modal .btn-secondary:hover {
  background: rgba(255, 255, 255, 0.2);
  border-color: rgba(255, 255, 255, 0.3);
}

/* Close button - Dark Mode */
body:not(.theme-light) .modal-close {
  color: #ffffff;
  background: rgba(255, 255, 255, 0.1);
}

body:not(.theme-light) .modal-close:hover {
  background: rgba(255, 255, 255, 0.2);
}

/* ========================================================================
   LIGHT MODE - Dark text on light backgrounds
   ======================================================================== */

/* Modal container - Light Mode */
body.theme-light .modal,
body.theme-light .category-modal,
body.theme-light .settings-modal,
body.theme-light .terminal-modal,
body.theme-light .service-copy-modal,
body.theme-light .slider-modal,
body.theme-light .ssh-manager-modal,
body.theme-light .icon-selector-modal,
body.theme-light .audit-log-modal,
body.theme-light .mobile-modal {
  background: #ffffff;
  color: #000000;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
}

/* Modal header - Light Mode */
body.theme-light .modal-header {
  color: #000000;
  border-bottom-color: rgba(0, 0, 0, 0.1);
  background: #ffffff;
}

body.theme-light .modal-header h2,
body.theme-light .modal-header h3 {
  color: #000000;
}

/* Form elements - Light Mode */
body.theme-light .modal label,
body.theme-light .modal .form-group label {
  color: rgba(0, 0, 0, 0.87);
  font-weight: 600;
}

body.theme-light .modal input,
body.theme-light .modal select,
body.theme-light .modal textarea {
  background: rgba(0, 0, 0, 0.05);
  color: #000000;
  border-color: rgba(0, 0, 0, 0.2);
}

body.theme-light .modal input:focus,
body.theme-light .modal select:focus,
body.theme-light .modal textarea:focus {
  background: #ffffff;
  border-color: #007aff;
  box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
}

body.theme-light .modal input::placeholder,
body.theme-light .modal textarea::placeholder {
  color: rgba(0, 0, 0, 0.5);
}

/* Modal footer - Light Mode */
body.theme-light .modal-footer {
  background: #ffffff;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

/* Buttons - Light Mode */
body.theme-light .modal .btn-secondary {
  background: rgba(0, 0, 0, 0.05);
  color: #000000;
  border: 1px solid rgba(0, 0, 0, 0.2);
}

body.theme-light .modal .btn-secondary:hover {
  background: rgba(0, 0, 0, 0.1);
  border-color: rgba(0, 0, 0, 0.3);
}

body.theme-light .modal .btn-primary {
  background: #007aff;
  color: #ffffff;
}

body.theme-light .modal .btn-primary:hover {
  background: #005bb5;
}

/* Close button - Light Mode */
body.theme-light .modal-close {
  color: #000000;
  background: rgba(0, 0, 0, 0.05);
}

body.theme-light .modal-close:hover {
  background: rgba(0, 0, 0, 0.1);
}

/* ========================================================================
   SPECIFIC MODAL ADJUSTMENTS
   ======================================================================== */

/* Category Modal - Light Mode specifics */
body.theme-light .category-preview-box {
  background: rgba(0, 0, 0, 0.03);
  border-color: rgba(0, 0, 0, 0.1);
}

body.theme-light .category-info-preview h4 {
  color: #000000;
}

body.theme-light .category-info-preview p {
  color: rgba(0, 0, 0, 0.6);
}

body.theme-light .icon-selector-trigger {
  background: rgba(0, 0, 0, 0.05);
  border-color: rgba(0, 0, 0, 0.2);
  color: #000000;
}

body.theme-light .icon-selector-trigger:hover {
  background: #ffffff;
  border-color: #007aff;
}

body.theme-light .selected-icon-name {
  color: #000000;
}

body.theme-light .icon-selector-info small {
  color: rgba(0, 0, 0, 0.6);
}

body.theme-light .edit-icon {
  color: rgba(0, 0, 0, 0.6);
}

/* SSH Host Manager Dialog - Light Mode */
body.theme-light .MuiDialog-paper {
  background: #ffffff !important;
  color: #000000 !important;
}

body.theme-light .MuiDialogTitle-root {
  color: #000000 !important;
}

body.theme-light .MuiTextField-root .MuiOutlinedInput-root {
  color: #000000 !important;
}

body.theme-light .MuiTextField-root .MuiOutlinedInput-root fieldset {
  border-color: rgba(0, 0, 0, 0.23) !important;
}

body.theme-light .MuiTextField-root .MuiInputLabel-root {
  color: rgba(0, 0, 0, 0.6) !important;
}

/* User Management Modal - Light Mode */
body.theme-light .MuiPaper-root {
  background-color: rgba(255, 255, 255, 0.9) !important;
  color: #000000 !important;
}

body.theme-light .MuiCard-root {
  background-color: rgba(0, 0, 0, 0.05) !important;
  border-color: rgba(0, 0, 0, 0.1) !important;
}

body.theme-light .MuiTab-root {
  color: rgba(0, 0, 0, 0.6) !important;
}

body.theme-light .MuiTab-root.Mui-selected {
  color: #007aff !important;
}

/* ========================================================================
   ERROR & SUCCESS MESSAGES
   ======================================================================== */

/* Error messages - Same for both themes */
.error-message {
  background: rgba(255, 59, 48, 0.1);
  border-color: rgba(255, 59, 48, 0.3);
  color: #ff3b30;
}

/* Success messages - Same for both themes */
.success-message {
  background: rgba(52, 199, 89, 0.1);
  border-color: rgba(52, 199, 89, 0.3);
  color: #34c759;
}

/* ========================================================================
   MOBILE ADJUSTMENTS
   ======================================================================== */

@media (max-width: 768px) {
  /* Ensure readability on mobile for both themes */
  body.theme-light .modal {
    background: #ffffff;
  }
  
  body.theme-light .modal-header {
    background: #ffffff;
  }
  
  body.theme-light .modal-footer {
    background: #ffffff;
    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05);
  }
}

/* Icon Selector Modal - Light Mode */
body.theme-light .icon-selector-modal {
  background: #ffffff;
  border-color: rgba(0, 0, 0, 0.1);
}

body.theme-light .icon-selector-header {
  background: #ffffff;
  border-bottom-color: rgba(0, 0, 0, 0.1);
}

body.theme-light .icon-selector-header h3 {
  color: #000000;
}

body.theme-light .icon-selector-controls {
  background: #ffffff;
  border-bottom-color: rgba(0, 0, 0, 0.1);
}

body.theme-light .search-input {
  background: rgba(0, 0, 0, 0.05);
  border-color: rgba(0, 0, 0, 0.2);
  color: #000000;
}

body.theme-light .search-input::placeholder {
  color: rgba(0, 0, 0, 0.5);
}

body.theme-light .search-icon {
  color: rgba(0, 0, 0, 0.5);
}

body.theme-light .close-btn {
  color: rgba(0, 0, 0, 0.6);
}

body.theme-light .close-btn:hover {
  background: rgba(0, 0, 0, 0.05);
  color: #000000;
}

body.theme-light .icon-selector-content {
  background: #f5f5f7;
}

body.theme-light .icon-grid {
  background: transparent;
}

body.theme-light .icon-item {
  background: #ffffff;
  border-color: rgba(0, 0, 0, 0.1);
  color: #000000;
}

/* Icon Selector Modal - Light Mode - HIGHEST SPECIFICITY */
body.theme-light .icon-selector-overlay .icon-selector-modal .icon-selector-content .icon-grid .icon-item:not(.selected) svg {
  color: #000000 !important;
  stroke: #000000 !important;
  fill: none !important;
}

body.theme-light .icon-selector-overlay .icon-selector-modal .icon-selector-content .icon-grid .icon-item.selected svg {
  color: #ffffff !important;
  stroke: #ffffff !important;
  fill: none !important;
}

/* Override CSS variables in Light Mode */
body.theme-light .icon-selector-modal {
  --text-primary: #000000;
  --text-secondary: rgba(0, 0, 0, 0.6);
  --background-secondary: rgba(0, 0, 0, 0.05);
  --card-background: #ffffff;
  --border-color: rgba(0, 0, 0, 0.1);
}

/* Force black color on non-selected icons */
body.theme-light .icon-item:not(.selected) {
  color: #000000 !important;
}

body.theme-light .icon-item:not(.selected) svg {
  color: #000000 !important;
  stroke: #000000 !important;
}

body.theme-light .icon-item:not(.selected) .lucide {
  color: #000000 !important;
  stroke: #000000 !important;
}

body.theme-light .icon-item:hover {
  background: #ffffff;
  border-color: #007aff;
  box-shadow: 0 4px 12px rgba(0, 122, 255, 0.15);
}

body.theme-light .icon-item.selected {
  background: #007aff;
  color: #ffffff;
  border-color: #007aff;
}

body.theme-light .icon-item.selected svg {
  color: #ffffff !important;
  stroke: #ffffff !important;
}

body.theme-light .icon-item.selected .lucide {
  color: #ffffff !important;
  stroke: #ffffff !important;
}

body.theme-light .icon-name {
  color: rgba(0, 0, 0, 0.6);
}

body.theme-light .icon-item.selected .icon-name {
  color: #ffffff;
}

body.theme-light .category-btn {
  background: rgba(0, 0, 0, 0.05);
  border-color: rgba(0, 0, 0, 0.1);
  color: rgba(0, 0, 0, 0.6);
}

body.theme-light .category-btn:hover {
  background: #ffffff;
  color: #000000;
  border-color: #007aff;
}

body.theme-light .category-btn.active {
  background: #007aff;
  color: #ffffff;
  border-color: #007aff;
}

body.theme-light .category-count {
  background: rgba(0, 0, 0, 0.1);
}

body.theme-light .category-btn.active .category-count {
  background: rgba(255, 255, 255, 0.3);
}

/* Service Copy Modal - Light Mode */
body.theme-light .service-copy-modal label {
  color: rgba(0, 0, 0, 0.87);
}

body.theme-light .service-copy-modal .preview-section {
  background: rgba(0, 0, 0, 0.03);
  border-color: rgba(0, 0, 0, 0.1);
}

/* Slider Modal - Light Mode */
body.theme-light .slider-modal-value {
  color: #007aff;
}

body.theme-light .slider-modal input[type="range"] {
  background: rgba(0, 0, 0, 0.1);
}

/* Audit Log Modal - Light Mode */
body.theme-light .audit-log-modal {
  background: #ffffff;
}

body.theme-light .audit-detail-content {
  background: rgba(0, 0, 0, 0.02);
  color: #000000;
}

/* Terminal Modal - Keep dark even in light mode for better readability */
body.theme-light .terminal-modal {
  background: #1a1a1a !important;
  color: #ffffff !important;
}

/* SSH Key Manager - Light Mode */
body.theme-light .ssh-manager-modal {
  background: #ffffff;
}

body.theme-light .ssh-manager-modal .key-item {
  background: rgba(0, 0, 0, 0.03);
  border-color: rgba(0, 0, 0, 0.1);
}

body.theme-light .ssh-manager-modal .key-item:hover {
  background: rgba(0, 0, 0, 0.05);
}

/* Mobile Modal - Light Mode */
body.theme-light .mobile-modal {
  background: #ffffff;
}

body.theme-light .mobile-modal-header {
  background: #ffffff;
  border-bottom-color: rgba(0, 0, 0, 0.1);
}

body.theme-light .mobile-modal-footer {
  background: #ffffff;
  border-top-color: rgba(0, 0, 0, 0.1);
}

/* Icon Selector Overlay - Light Mode */
body.theme-light .icon-selector-overlay {
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
}

/* No icons found message - Light Mode */
body.theme-light .no-icons-found {
  color: rgba(0, 0, 0, 0.6);
}

/* Clear search button - Light Mode */
body.theme-light .clear-search-btn {
  color: rgba(0, 0, 0, 0.5);
}

body.theme-light .clear-search-btn:hover {
  background: rgba(0, 0, 0, 0.05);
  color: #000000;
}

/* Ensure proper contrast for focused elements */
body.theme-light .search-input:focus {
  background: #ffffff;
  border-color: #007aff;
  box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
}

/* Loading state - Light Mode */
body.theme-light .icon-loading {
  color: rgba(0, 0, 0, 0.5);
}

/* ========================================================================
   WEITERE MODAL-ANPASSUNGEN FÜR LIGHT MODE
   ======================================================================== */

/* Icon buttons in modal headers - Light Mode */
body.theme-light .modal-header button:not(.modal-close) svg,
body.theme-light .modal-header .lucide {
  color: rgba(0, 0, 0, 0.7);
}

/* Sicherstellen, dass modale Dialoge über allem anderen sind */
.icon-selector-overlay {
  z-index: 10001 !important;
}

.icon-selector-modal {
  z-index: 10002 !important;
}

/* Fix für verschachtelte Modals */
.modal-overlay + .icon-selector-overlay {
  z-index: 10003 !important;
}

.modal-overlay + .icon-selector-overlay .icon-selector-modal {
  z-index: 10004 !important;
}

/* Accessibility improvements */
body.theme-light .modal:focus,
body.theme-light .icon-selector-modal:focus {
  outline: 2px solid #007aff;
  outline-offset: 2px;
}

/* Ensure proper scrollbar styling in Light Mode */
body.theme-light .icon-selector-content::-webkit-scrollbar {
  width: 8px;
}

body.theme-light .icon-selector-content::-webkit-scrollbar-track {
  background: rgba(0, 0, 0, 0.05);
  border-radius: 4px;
}

body.theme-light .icon-selector-content::-webkit-scrollbar-thumb {
  background: rgba(0, 0, 0, 0.2);
  border-radius: 4px;
}

body.theme-light .icon-selector-content::-webkit-scrollbar-thumb:hover {
  background: rgba(0, 0, 0, 0.3);
}

/* ========================================================================
   LUCIDE ICONS FIX FÜR LIGHT MODE
   ======================================================================== */

/* Generelle Lucide Icon Fixes für Light Mode */
body.theme-light .lucide {
  color: currentColor;
  stroke: currentColor;
}

/* Icon Selector spezifische Fixes */
body.theme-light .icon-selector-modal .simple-icon,
body.theme-light .icon-selector-modal .lucide {
  color: inherit !important;
  stroke: currentColor !important;
}

/* Hover State für Icons */
body.theme-light .icon-item:hover svg,
body.theme-light .icon-item:hover .lucide {
  color: #000000 !important;
  stroke: #000000 !important;
}

/* Force icon visibility in grid */
body.theme-light .icon-grid .icon-item {
  color: #000000 !important;
}

body.theme-light .icon-grid .icon-item svg,
body.theme-light .icon-grid .icon-item .lucide,
body.theme-light .icon-grid .icon-item .simple-icon {
  color: #000000 !important;
  stroke: #000000 !important;
  fill: none !important;
}

/* Selected state override */
body.theme-light .icon-grid .icon-item.selected {
  color: #ffffff !important;
}

body.theme-light .icon-grid .icon-item.selected svg,
body.theme-light .icon-grid .icon-item.selected .lucide,
body.theme-light .icon-grid .icon-item.selected .simple-icon {
  color: #ffffff !important;
  stroke: #ffffff !important;
  fill: none !important;
}

/* Debug: Extra specificity for troublesome icons */
body.theme-light .icon-selector-content .icon-item:not(.selected) svg path,
body.theme-light .icon-selector-content .icon-item:not(.selected) .lucide path {
  stroke: #000000 !important;
}

body.theme-light .icon-selector-content .icon-item.selected svg path,
body.theme-light .icon-selector-content .icon-item.selected .lucide path {
  stroke: #ffffff !important;
}

/* ========================================================================
   GLOBALE SVG ICON FIXES
   ======================================================================== */

/* Verhindere, dass Icons unsichtbar werden */
body.theme-light svg:not([fill]) {
  fill: none !important;
}

/* Stelle sicher, dass stroke-basierte Icons sichtbar sind */
body.theme-light svg[stroke="currentColor"] {
  stroke: currentColor !important;
}

/* Icon Selector Modal - Zusätzliche Spezifität */
body.theme-light .icon-selector-modal .icon-item:not(.selected) {
  color: #000000 !important;
}

body.theme-light .icon-selector-modal .icon-item:not(.selected) * {
  color: inherit !important;
}

/* Fallback für hartnäckige Icons */
body.theme-light .icon-selector-modal .icon-item:not(.selected) svg {
  opacity: 1 !important;
  visibility: visible !important;
}

/* Icon visibility in other modals */
body.theme-light .modal .lucide,
body.theme-light .modal svg {
  color: currentColor;
}

/* Fix für den Close Button im Icon Selector */
body.theme-light .icon-selector-header .close-btn svg {
  color: rgba(0, 0, 0, 0.6) !important;
  stroke: rgba(0, 0, 0, 0.6) !important;
}

body.theme-light .icon-selector-header .close-btn:hover svg {
  color: #000000 !important;
  stroke: #000000 !important;
}
